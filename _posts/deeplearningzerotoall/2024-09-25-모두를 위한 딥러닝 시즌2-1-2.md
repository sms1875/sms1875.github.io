---
layout: post
title: "모두를 위한 딥러닝 시즌2-1-2"
date: 2024-10-03 15:30:00
categories: [Study, 모두를 위한 딥러닝 시즌2]
tags: [모두를 위한 딥러닝 시즌2, ML, DL, pytorch]
---
{% include embed/youtube.html id='XkqdNaNQGx8' %}  

## View (Reshape)

- 텐서의 모양을 원하는 대로 변경하는 기능
- **-1**: 차원을 지정하지 않음, 보통 가장 변동이 심한 배치 사이즈에 사용
- 새로운 차원 dim들의 곱 = 기존 차원 dim들의 곱
- **차원의 저주** 해결을 위해 사용하는 기법

### 예시

```python
t = np.array([[[0, 1, 2],
               [3, 4, 5]],

              [[6, 7, 8],
               [9, 10, 11]]])
ft = torch.FloatTensor(t)
print(ft.shape)
# torch.Size([2, 2, 3])

# View로 텐서의 차원을 바꾸기
print(ft.view([-1, 3]))
print(ft.view([-1, 3]).shape)
# tensor([[ 0.,  1.,  2.],
#         [ 3.,  4.,  5.],
#         [ 6.,  7.,  8.],
#         [ 9., 10., 11.]])
# torch.Size([4, 3])

print(ft.view([-1, 1, 3]))
print(ft.view([-1, 1, 3]).shape)
# tensor([[[ 0.,  1.,  2.]],
#         [[ 3.,  4.,  5.]],
#         [[ 6.,  7.,  8.]],
#         [[ 9., 10., 11.]]])
# torch.Size([4, 1, 3])
```

---

## Squeeze

- 디멘션에서 엘리먼트의 값이 1인 경우 그 차원을 제거하는 함수
- **dim**을 명시하지 않으면 1인 차원 모두를 제거

### 예시

```python
ft = torch.FloatTensor([[0], [1], [2]])
print(ft)
print(ft.shape)
# tensor([[0.],
#         [1.],
#         [2.]])
# torch.Size([3, 1])

print(ft.squeeze())
print(ft.squeeze().shape)
# tensor([0., 1., 2.])
# torch.Size([3])
```

---

## Unsqueeze

- 원하는 차원에 1을 추가하여 새로운 차원을 만들 때 사용
- **dim**을 명시하여 해당 차원에 1을 추가

### 예시

```python
ft = torch.FloatTensor([0, 1, 2])
print(ft.shape)
# torch.Size([3])

print(ft.unsqueeze(0))
print(ft.unsqueeze(0).shape)
# tensor([[0., 1., 2.]])
# torch.Size([1, 3])

print(ft.unsqueeze(1))
print(ft.unsqueeze(1).shape)
# tensor([[0.],
#         [1.],
#         [2.]])
# torch.Size([3, 1])
```

---

## Type Casting

- 텐서의 타입을 변경 (예: long → float)

### 예시

```python
lt = torch.LongTensor([1, 2, 3, 4])
print(lt)
# tensor([1, 2, 3, 4])

print(lt.float())
# tensor([1., 2., 3., 4.])

bt = torch.ByteTensor([True, False, False, True])
print(bt)
# tensor([1, 0, 0, 1], dtype=torch.uint8)

print(bt.long())
print(bt.float())
# tensor([1, 0, 0, 1])
# tensor([1., 0., 0., 1.])
```

> **byte type**은 조건에 따라 True, False를 자동으로 생성이 가능
> ```python
> # LongTensor 생성
> lt = torch.LongTensor([1, 2, 3, 4, 5, 6])
> 
> # 조건에 따라 ByteTensor 생성: lt의 값이 3보다 큰 경우 True, 나머지는 False
> bt = lt > 3
> print(bt)
> # tensor([False, False, False,  True,  True,  True])
> ```
> 마스킹 등에 활용  
{: .prompt-tip}  

---

## Concatenation

### 개념
- 텐서들을 지정한 **dim**을 기준으로 이어붙임

### 예시

```python
x = torch.FloatTensor([[1, 2], [3, 4]])
y = torch.FloatTensor([[5, 6], [7, 8]])

print(torch.cat([x, y], dim=0))
# tensor([[1., 2.],
#         [3., 4.],
#         [5., 6.],
#         [7., 8.]])

print(torch.cat([x, y], dim=1))
# tensor([[1., 2., 5., 6.],
#         [3., 4., 7., 8.]])
```

---

## Stacking

### 개념
- 텐서를 쌓아 새로운 차원을 생성하는 방식
- **unsqueeze**와 **cat**을 이용한 방식과 동일하게 동작

### 예시

```python
x = torch.FloatTensor([1, 4])
y = torch.FloatTensor([2, 5])
z = torch.FloatTensor([3, 6])

print(torch.stack([x, y, z]))
# tensor([[1., 4.],
#         [2., 5.],
#         [3., 6.]])

print(torch.stack([x, y, z], dim=1))
# tensor([[1., 2., 3.],
#         [4., 5., 6.]])
```

---

## Ones and Zeros Like

### 개념
- 주어진 텐서와 동일한 크기(shape)로 **1** 또는 **0**을 채운 새로운 텐서를 생성

### 예시

```python
x = torch.FloatTensor([[0, 1, 2], [2, 1, 0]])
print(x)
# tensor([[0., 1., 2.],
#         [2., 1., 0.]])

print(torch.ones_like(x))
# tensor([[1., 1., 1.],
#         [1., 1., 1.]])

print(torch.zeros_like(x))
# tensor([[0., 0., 0.],
#         [0., 0., 0.]])
```

---

## In-place Operation

### 개념
- 메모리를 새로 할당하지 않고 기존 텐서를 수정하는 연산
- 연산 함수에 **언더바(_)**를 붙여서 사용

### 예시

```python
x = torch.FloatTensor([[1, 2], [3, 4]])

print(x.mul(2.))
# tensor([[2., 4.],
#         [6., 8.]])
print(x)
# tensor([[1., 2.],
#         [3., 4.]])

print(x.mul_(2.))
print(x)
# tensor([[2., 4.],
#         [6., 8.]])
```

```markdown
**In-place 연산**: 기존 메모리를 사용하므로 속도 이점이 있음
```

---

## Zip

### 개념
- 여러 리스트나 텐서를 하나씩 짝지어주는 파이썬 함수

### 예시

```python
for x, y in zip([1, 2, 3], [4, 5, 6]):
    print(x, y)
# 1 4
# 2 5
# 3 6

for x, y, z in zip([1, 2, 3], [4, 5, 6], [7, 8, 9]):
    print(x, y, z)
# 1 4 7
# 2 5 8
# 3 6 9
```
